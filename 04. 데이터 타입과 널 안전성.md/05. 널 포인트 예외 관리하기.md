## 널 안전성이란?

널 안전성이란 널 포인트 예외를 프로그램 실행 전 코드를 작성하는 시점에 점검하는 것이다. 널 포인트 예외는 객체가 특정 값이 아닌 null을 가리켜서 발생하는 오류로, 컴파일러가 걸러내지 못하고 프로그램 실행 중에 발생하므로 치명적일 수 있다.  
플러터 2.12.0 버전 이상은 널 안전성을 지원하지 않는 패키지는 이용할 수 없다. pub.dev 사이트에서 'Null safety' 라고 표시된 패키지만 사용할 수 있다.

## 널 허용과 널 불허

널 안전성을 지원하는 프로그래밍 언어에서 변수를 선언할 때 널 허용과 널 불허로 구분한다. 컴파일러에 널을 대입할 수 있는지 없는지를 명확하게 알려 줘야 널 불허 변수에 널이 대입되거나 NPE를 고려하지 않고 널 허용 변수를 이용할 때 컴파일러가 알아서 오류를 알려 준다. 따라서 개발자는 NPE가 발생하지 않는 코드를 작성할 수 있다.  
다트 언어에서 변수는 널 불허로 선언된다. 널 허용으로 선언하기 위해서는 타입 뒤에 물음표를 추가해야 한다. 널 허용, 널 불허 변수 선언법은 모든 타입에 적용된다.

## 널 불허 변수의 초기화

다트에서 모든 변수는 객체로, 선언하면서 초깃값을 정해 주지 않으면 널로 초기화된다. 하지만 널 불허로 선언한 변수는 오류가 나기 때문에 초기화 해주어야 한다.  
하지만 널 불허 변수를 초기화해야 하는 규칙은 톱 레벨에 선언된 변수와 클래스의 멤버 변수에만 해당한다. 함수에서 지역 변수를 널 불허로 선언할 때는 초기화하지 않아도 되지만, 사용할 때 값을 입력해 주어야 한다. 

&#8251; 변수를 선언할 때 항상 물음표를 붙여서 널 허용으로 하면 객체의 멤버를 이용할 때 널 안전성 연산자를 이용해야 하기 때문에 널 불허로 선언할 수 있는 변수를 굳이 널 허용으로 선언하면 코드가 복잡해 질 수 있다.  

## var 타입의 널 안전성

var로 선언한 변수는 널 허용 여부도 대입하는 값에 따라 컴파일러가 자동으로 결정하기 때문에 물음표를 붙일 수 없다.

## dynamic 타입의 널 안전성

dynamic 타입에는 물음표를 추가할 수 있지만 의미가 없다. 모든 타입의 데이터를 대입할 수 있으므로 널을 허용하는 Nullable도 포함된다.

## 널 안전성과 형 변환

널 허용과 널 불허는 타입(클래스)이다. 그렇기 때문에 형 변환과 관련된 내용도 중요하다. 널 허용이 널 불허의 상위 타입이다. 즉, 널 불허 변수를 널 허용에 대입이 가능하지만 반대는 불가능하다. 가능하게 하려면 as를 사용하여 명시적으로 형 변환을 해줘야 한다.
```
# 명시적 형 변환

int a1 = 10;
int? a2 = 20;

main(){
    a1 = a2 as int;
    print("a1: $a1, a2: $a2");
}

출력 -> a1: 20, a2: 20
```

## 초기화를 미루는 late 연산자

널 불허 변수는 선언과 동시에 초기화해야 한다. 하지만 초기화하기 모호하다면 late 연산자를 사용해 변수를 널인 상태로 이용하다가 앱이 실행될 때 값을 결정할 수 있다. 변수를 사용할 때는 값을 대입하고 사용해야 한다.
```
# 초기화 미루기

int a1;
late int a2;
```